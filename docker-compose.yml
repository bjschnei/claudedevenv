services:
  claude-dev:
    build: .
    container_name: ${CONTAINER_NAME:-claude-code-dev}
    user: root  # Run as root to handle docker.sock permissions dynamically
    volumes:
      - "${HOME}/.claude:/home/developer/.claude"
      - "${HOME}/.claude:${HOME}/.claude:ro"
      - "${PROJECT_DIR:-.}:/home/developer/workspace"
      - "/var/run/docker.sock:/var/run/docker.sock"
    working_dir: /home/developer/workspace
    stdin_open: true
    tty: true
    # Required for Chromium sandbox (Playwright MCP browser automation)
    cap_add:
      - SYS_ADMIN
    security_opt:
      - seccomp:unconfined
    environment:
      - IMPORT_AGENT_OS_PROFILES=${IMPORT_AGENT_OS_PROFILES:-}
